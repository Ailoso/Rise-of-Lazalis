include "TriggerLibs/NativeLib"

include "Lib4A5CBC7B_h"

//--------------------------------------------------------------------------------------------------
// Library: Rise of Lazalis
//--------------------------------------------------------------------------------------------------
// External Library Initialization
void lib4A5CBC7B_InitLibraries () {
    libNtve_InitVariables();
}

// Variable Initialization
bool lib4A5CBC7B_InitVariables_completed = false;

void lib4A5CBC7B_InitVariables () {
    if (lib4A5CBC7B_InitVariables_completed) {
        return;
    }

    lib4A5CBC7B_InitVariables_completed = true;

}

// Triggers
//--------------------------------------------------------------------------------------------------
// Trigger: Init
//--------------------------------------------------------------------------------------------------
bool lib4A5CBC7B_gt_Init_Func (bool testConds, bool runActions) {
    // Automatic Variable Declarations
    // Actions
    if (!runActions) {
        return true;
    }

    PlayerSetRace(1, "Terr");
    PlayerOptionOverride(1, "tickedunitstatus", "0");
    PlayerSetColorIndex(1, 15, true);
    return true;
}

//--------------------------------------------------------------------------------------------------
void lib4A5CBC7B_gt_Init_Init () {
    lib4A5CBC7B_gt_Init = TriggerCreate("lib4A5CBC7B_gt_Init_Func");
    TriggerAddEventMapInit(lib4A5CBC7B_gt_Init);
}

//--------------------------------------------------------------------------------------------------
// Trigger: Tooltip Appender On
//--------------------------------------------------------------------------------------------------
bool lib4A5CBC7B_gt_TooltipAppenderOn_Func (bool testConds, bool runActions) {
    // Automatic Variable Declarations
    // Actions
    if (!runActions) {
        return true;
    }

    UnitBehaviorAdd(UnitGroupUnit(UnitGroupSelected(1), 1), "UP1Appender", UnitGroupUnit(UnitGroupSelected(1), 1), 1);
    UnitBehaviorAdd(UnitGroupUnit(UnitGroupSelected(1), 1), "MakeshiftBunkerAppender", UnitGroupUnit(UnitGroupSelected(1), 1), 1);
    return true;
}

//--------------------------------------------------------------------------------------------------
void lib4A5CBC7B_gt_TooltipAppenderOn_Init () {
    lib4A5CBC7B_gt_TooltipAppenderOn = TriggerCreate("lib4A5CBC7B_gt_TooltipAppenderOn_Func");
    TriggerAddEventKeyPressed(lib4A5CBC7B_gt_TooltipAppenderOn, 1, c_keyAlt, true, c_keyModifierStateIgnore, c_keyModifierStateIgnore, c_keyModifierStateIgnore);
}

//--------------------------------------------------------------------------------------------------
// Trigger: Tooltip Appender Off
//--------------------------------------------------------------------------------------------------
bool lib4A5CBC7B_gt_TooltipAppenderOff_Func (bool testConds, bool runActions) {
    // Automatic Variable Declarations
    // Actions
    if (!runActions) {
        return true;
    }

    UnitBehaviorRemove(UnitGroupUnit(UnitGroupSelected(1), 1), "UP1Appender", 1);
    UnitBehaviorRemove(UnitGroupUnit(UnitGroupSelected(1), 1), "MakeshiftBunkerAppender", 1);
    return true;
}

//--------------------------------------------------------------------------------------------------
void lib4A5CBC7B_gt_TooltipAppenderOff_Init () {
    lib4A5CBC7B_gt_TooltipAppenderOff = TriggerCreate("lib4A5CBC7B_gt_TooltipAppenderOff_Func");
    TriggerAddEventKeyPressed(lib4A5CBC7B_gt_TooltipAppenderOff, c_playerAny, c_keyAlt, false, c_keyModifierStateExclude, c_keyModifierStateExclude, c_keyModifierStateIgnore);
}

//--------------------------------------------------------------------------------------------------
// Trigger: Dismantle Resources
//--------------------------------------------------------------------------------------------------
bool lib4A5CBC7B_gt_DismantleResources_Func (bool testConds, bool runActions) {
    // Automatic Variable Declarations
    // Actions
    if (!runActions) {
        return true;
    }

    PlayerModifyPropertyFixed(EventPlayer(), c_playerPropMinerals, c_playerPropOperAdd, (UnitTypeGetCost(UnitGetType(EventPlayerEffectUsedUnitImpact()), c_unitCostMinerals) * 0.75));
    PlayerModifyPropertyFixed(EventPlayer(), c_playerPropVespene, c_playerPropOperAdd, (UnitTypeGetCost(UnitGetType(EventPlayerEffectUsedUnitImpact()), c_unitCostVespene) * 0.75));
    return true;
}

//--------------------------------------------------------------------------------------------------
void lib4A5CBC7B_gt_DismantleResources_Init () {
    lib4A5CBC7B_gt_DismantleResources = TriggerCreate("lib4A5CBC7B_gt_DismantleResources_Func");
    TriggerAddEventPlayerEffectUsed(lib4A5CBC7B_gt_DismantleResources, c_playerAny, "Dismantle");
}

//--------------------------------------------------------------------------------------------------
// Trigger: Retreat!
//--------------------------------------------------------------------------------------------------
bool lib4A5CBC7B_gt_Retreat_Func (bool testConds, bool runActions) {
    // Variable Declarations
    string lv_unitType;

    // Automatic Variable Declarations
    // Variable Initialization

    // Actions
    if (!runActions) {
        return true;
    }

    lv_unitType = UnitGetType(EventUnit());
    UnitIssueOrder(EventUnit(), OrderTargetingUnit(AbilityCommand("move", 0), UnitGroupClosestToPoint(UnitGroup("CommandCenter", EventPlayer(), RegionEntireMap(), UnitFilter(0, 0, (1 << c_targetFilterMissile), (1 << (c_targetFilterDead - 32)) | (1 << (c_targetFilterHidden - 32))), 0), UnitGetPosition(EventUnit()))), c_orderQueueReplace);
    UnitSelect(EventUnit(), EventPlayer(), false);
    if ((lib4A5CBC7B_gv_retreatingUnitType == UnitGetType(EventUnit()))) {
    }
    else {
        SoundPlayOnUnitForPlayer(SoundLink(((StringSub(CatalogFieldValueGet(c_gameCatalogUnit, UnitGetType(EventUnit()), "Name", c_playerAny), 11, 99) + "_Retreat")), c_soundIndexAny), EventPlayer(), PlayerGroupAll(), EventUnit(), 0.0, 100.0, 0.0);
    }
    lib4A5CBC7B_gv_retreatingUnitType = UnitGetType(EventUnit());
    Wait(8.0, c_timeGame);
    if ((lv_unitType == lib4A5CBC7B_gv_retreatingUnitType)) {
        lib4A5CBC7B_gv_retreatingUnitType = "";
    }

    return true;
}

//--------------------------------------------------------------------------------------------------
void lib4A5CBC7B_gt_Retreat_Init () {
    lib4A5CBC7B_gt_Retreat = TriggerCreate("lib4A5CBC7B_gt_Retreat_Func");
    TriggerAddEventUnitAbility(lib4A5CBC7B_gt_Retreat, null, AbilityCommand("Retreat", 0), c_unitAbilStageExecute, false);
}

//--------------------------------------------------------------------------------------------------
// Trigger: Retreat! Re-Order
//--------------------------------------------------------------------------------------------------
bool lib4A5CBC7B_gt_RetreatReOrder_Func (bool testConds, bool runActions) {
    // Automatic Variable Declarations
    // Conditions
    if (testConds) {
        if (!((UnitHasBehavior2(EventUnit(), "Retreating") == true))) {
            return false;
        }
    }

    // Actions
    if (!runActions) {
        return true;
    }

    UnitIssueOrder(EventUnit(), OrderTargetingUnit(AbilityCommand("move", 0), UnitGroupClosestToPoint(UnitGroup("CommandCenter", EventPlayer(), RegionEntireMap(), UnitFilter(0, 0, (1 << c_targetFilterMissile), (1 << (c_targetFilterDead - 32)) | (1 << (c_targetFilterHidden - 32))), 0), UnitGetPosition(EventUnit()))), c_orderQueueReplace);
    return true;
}

//--------------------------------------------------------------------------------------------------
void lib4A5CBC7B_gt_RetreatReOrder_Init () {
    lib4A5CBC7B_gt_RetreatReOrder = TriggerCreate("lib4A5CBC7B_gt_RetreatReOrder_Func");
    TriggerAddEventUnitBecomesIdle(lib4A5CBC7B_gt_RetreatReOrder, null, true);
}

//--------------------------------------------------------------------------------------------------
// Trigger: AO-155 Rifle
//--------------------------------------------------------------------------------------------------
bool lib4A5CBC7B_gt_AO155Rifle_Func (bool testConds, bool runActions) {
    // Variable Declarations
    int lv_count;
    int lv_weaponSlot;

    // Automatic Variable Declarations
    const int auto92549A4E_ae = 10;
    const int auto92549A4E_ai = 1;

    // Variable Initialization
    lv_count = 10;

    // Actions
    if (!runActions) {
        return true;
    }

    lv_count = 1;
    for ( ; ( (auto92549A4E_ai >= 0 && lv_count <= auto92549A4E_ae) || (auto92549A4E_ai < 0 && lv_count >= auto92549A4E_ae) ) ; lv_count += auto92549A4E_ai ) {
        lv_weaponSlot += 1;
        UnitWeaponRemove(EventUnit(), UnitWeaponGet(EventUnit(), lv_weaponSlot));
    }
    Wait(0.0625, c_timeGame);
    UnitWeaponAdd(EventUnit(), "AO155Rifle", null);
    return true;
}

//--------------------------------------------------------------------------------------------------
void lib4A5CBC7B_gt_AO155Rifle_Init () {
    lib4A5CBC7B_gt_AO155Rifle = TriggerCreate("lib4A5CBC7B_gt_AO155Rifle_Func");
    TriggerAddEventUnitBehaviorChange(lib4A5CBC7B_gt_AO155Rifle, null, "AO155Rifle", c_unitBehaviorChangeCreate);
}

//--------------------------------------------------------------------------------------------------
// Trigger: Bearclaw Flamethrower
//--------------------------------------------------------------------------------------------------
bool lib4A5CBC7B_gt_BearclawFlamethrower_Func (bool testConds, bool runActions) {
    // Variable Declarations
    int lv_count;
    int lv_weaponSlot;

    // Automatic Variable Declarations
    const int auto9191B8EF_ae = 10;
    const int auto9191B8EF_ai = 1;

    // Variable Initialization
    lv_count = 10;

    // Actions
    if (!runActions) {
        return true;
    }

    lv_count = 1;
    for ( ; ( (auto9191B8EF_ai >= 0 && lv_count <= auto9191B8EF_ae) || (auto9191B8EF_ai < 0 && lv_count >= auto9191B8EF_ae) ) ; lv_count += auto9191B8EF_ai ) {
        lv_weaponSlot += 1;
        UnitWeaponRemove(EventUnit(), UnitWeaponGet(EventUnit(), lv_weaponSlot));
    }
    Wait(0.0625, c_timeGame);
    UnitWeaponAdd(EventUnit(), "BearclawFlamethrower", null);
    return true;
}

//--------------------------------------------------------------------------------------------------
void lib4A5CBC7B_gt_BearclawFlamethrower_Init () {
    lib4A5CBC7B_gt_BearclawFlamethrower = TriggerCreate("lib4A5CBC7B_gt_BearclawFlamethrower_Func");
    TriggerAddEventUnitBehaviorChange(lib4A5CBC7B_gt_BearclawFlamethrower, null, "BearclawFlamethrower", c_unitBehaviorChangeCreate);
}

//--------------------------------------------------------------------------------------------------
// Trigger: 76 AP Rifle
//--------------------------------------------------------------------------------------------------
bool lib4A5CBC7B_gt__76APRifle_Func (bool testConds, bool runActions) {
    // Variable Declarations
    int lv_count;
    int lv_weaponSlot;

    // Automatic Variable Declarations
    const int autoB7F7DEF3_ae = 10;
    const int autoB7F7DEF3_ai = 1;

    // Variable Initialization
    lv_count = 10;

    // Actions
    if (!runActions) {
        return true;
    }

    lv_count = 1;
    for ( ; ( (autoB7F7DEF3_ai >= 0 && lv_count <= autoB7F7DEF3_ae) || (autoB7F7DEF3_ai < 0 && lv_count >= autoB7F7DEF3_ae) ) ; lv_count += autoB7F7DEF3_ai ) {
        lv_weaponSlot += 1;
        UnitWeaponRemove(EventUnit(), UnitWeaponGet(EventUnit(), lv_weaponSlot));
    }
    Wait(0.0625, c_timeGame);
    UnitWeaponAdd(EventUnit(), "76APRifle", null);
    return true;
}

//--------------------------------------------------------------------------------------------------
void lib4A5CBC7B_gt__76APRifle_Init () {
    lib4A5CBC7B_gt__76APRifle = TriggerCreate("lib4A5CBC7B_gt__76APRifle_Func");
    TriggerAddEventUnitBehaviorChange(lib4A5CBC7B_gt__76APRifle, null, "76APRifle", c_unitBehaviorChangeCreate);
}

void lib4A5CBC7B_InitTriggers () {
    lib4A5CBC7B_gt_Init_Init();
    lib4A5CBC7B_gt_TooltipAppenderOn_Init();
    lib4A5CBC7B_gt_TooltipAppenderOff_Init();
    lib4A5CBC7B_gt_DismantleResources_Init();
    lib4A5CBC7B_gt_Retreat_Init();
    lib4A5CBC7B_gt_RetreatReOrder_Init();
    lib4A5CBC7B_gt_AO155Rifle_Init();
    lib4A5CBC7B_gt_BearclawFlamethrower_Init();
    lib4A5CBC7B_gt__76APRifle_Init();
}

//--------------------------------------------------------------------------------------------------
// Library Initialization
//--------------------------------------------------------------------------------------------------
bool lib4A5CBC7B_InitLib_completed = false;

void lib4A5CBC7B_InitLib () {
    if (lib4A5CBC7B_InitLib_completed) {
        return;
    }

    lib4A5CBC7B_InitLib_completed = true;

    lib4A5CBC7B_InitLibraries();
    lib4A5CBC7B_InitVariables();
    lib4A5CBC7B_InitTriggers();
}

